<!DOCTYPE html>
<html>
<head>
    <title>Gridley AFL Assistant</title>
    <style>
        body { font-family: Arial; background:#f4f4f4; padding:20px; }
        table { border-collapse: collapse; width:100%; background:white; }
        th, td { border:1px solid #ddd; padding:6px; text-align:center; vertical-align:top; }
        th { background:#222; color:white; }
        tr:nth-child(even) { background:#f2f2f2; }
        .box { background:white; padding:15px; margin-bottom:20px; }
        label { margin-right:15px; white-space:nowrap; }
        input[type="number"] { width:80px; }
        .club-stats { font-size:12px; text-align:left; }
        .club-stats div { margin-bottom:2px; }
        .aa-years { font-size:11px; color:#555; text-align:left; }
        .draft-pick { font-size:11px; color:#333; font-weight:bold; }
    </style>
</head>
<body>

<h1>üèâ Gridley AFL Assistant</h1>

<div class="box">
<form method="get">

<strong>Teams</strong><br>

Team 1:
<select name="team1">
    <option value="">Any</option>
    {% for t in teams %}
        <option value="{{ t }}" {% if filters.team1 == t %}selected{% endif %}>{{ t }}</option>
    {% endfor %}
</select>

Team 2:
<select name="team2">
    <option value="">Any</option>
    {% for t in teams %}
        <option value="{{ t }}" {% if filters.team2 == t %}selected{% endif %}>{{ t }}</option>
    {% endfor %}
</select>

<br><br>

<strong>Teammates</strong><br>

Teammates of:
<input list="playerlist" name="teammate_of" style="width:420px;"
       value="{{ filters.teammate_of or '' }}"
       placeholder="Start typing a player name...">

<datalist id="playerlist">
{% for p in player_options %}
    <option value="{{ p['player_id'] }}">{{ p['name'] }}</option>
{% endfor %}
</datalist>

<br><br>

<strong>Career</strong><br>

Min Games:
<input type="number" name="min_games" value="{{ filters.min_games or '' }}">

Max Games:
<input type="number" name="max_games" value="{{ filters.max_games or '' }}">

Min Goals (Career):
<input type="number" name="min_goals" value="{{ filters.min_goals or '' }}">

Max Goals (Career):
<input type="number" name="max_goals" value="{{ filters.max_goals or '' }}">

<br><br>

<strong>Season Peaks</strong><br>

Min Goals (Season):
<input type="number" name="min_max_goals_season" value="{{ filters.min_max_goals_season or '' }}">

<br><br>

<strong>Single Game Peaks</strong><br>

Min Goals (Game):
<input type="number" name="min_max_goals_game" value="{{ filters.min_max_goals_game or '' }}">

<br><br>

<strong>All-Australian</strong><br>

Min Selections:
<input type="number" name="min_all_aus" value="{{ filters.min_all_aus or '' }}">

Max Draft Pick (AA):
<input type="number" name="max_aa_draft_pick" value="{{ filters.max_aa_draft_pick or '' }}">

<br><br>

<strong>Height (cm)</strong><br>

Min Height:
<input type="number" name="min_height" value="{{ filters.min_height or '' }}">

Max Height:
<input type="number" name="max_height" value="{{ filters.max_height or '' }}">

<br><br>

<strong>Career Years</strong><br>

Debuted After:
<input type="number" name="min_first_year" value="{{ filters.min_first_year or '' }}">

Played After:
<input type="number" name="min_last_year" value="{{ filters.min_last_year or '' }}">

<br><br>

<strong>Brownlow</strong><br>

Min Wins:
<input type="number" name="min_wins" value="{{ filters.min_wins or '' }}">

Min Votes:
<input type="number" name="min_votes" value="{{ filters.min_votes or '' }}">

<br><br>

<strong>Sort</strong><br>

<select name="sort_by">
    <option value="career_games">Career Games</option>
    <option value="career_goals">Career Goals</option>
    <option value="max_goals_game">Max Goals (Game)</option>
    <option value="max_goals_season">Max Goals (Season)</option>
    <option value="all_aus_count">All-Australian Selections</option>
    <option value="brownlow_votes">Brownlow Votes</option>
    <option value="brownlow_wins">Brownlow Wins</option>
    <option value="gf_wins">GF Wins</option>
    <option value="first_year">First Year</option>
    <option value="last_year">Last Year</option>
</select>

<select name="sort_order">
    <option value="DESC">Descending</option>
    <option value="ASC">Ascending</option>
</select>

<br><br>

<strong>Display Columns</strong><br>

<label><input type="checkbox" name="show_career_games" {% if visible.career_games %}checked{% endif %}> Career Games</label>
<label><input type="checkbox" name="show_career_goals" {% if visible.career_goals %}checked{% endif %}> Career Goals</label>
<label><input type="checkbox" name="show_max_goals_game" {% if visible.max_goals_game %}checked{% endif %}> Max Goals (Game)</label>
<label><input type="checkbox" name="show_max_goals_season" {% if visible.max_goals_season %}checked{% endif %}> Max Goals (Season)</label>
<label><input type="checkbox" name="show_max_goals_season_year" {% if visible.max_goals_season_year %}checked{% endif %}> Season Year</label>
<label><input type="checkbox" name="show_max_disposals" {% if visible.max_disposals_game %}checked{% endif %}> Max Disposals</label>
<label><input type="checkbox" name="show_max_kicks" {% if visible.max_kicks_game %}checked{% endif %}> Max Kicks</label>

<label><input type="checkbox" name="show_all_aus" {% if visible.all_aus %}checked{% endif %}> All-Australian Count</label>
<label><input type="checkbox" name="show_all_aus_years" {% if visible.all_aus_years %}checked{% endif %}> AA Years</label>
<label><input type="checkbox" name="show_aa_draft_pick" {% if visible.aa_draft_pick %}checked{% endif %}> AA Draft Pick</label>

<label><input type="checkbox" name="show_wins" {% if visible.brownlow_wins %}checked{% endif %}> Brownlow Wins</label>
<label><input type="checkbox" name="show_votes" {% if visible.brownlow_votes %}checked{% endif %}> Brownlow Votes</label>
<label><input type="checkbox" name="show_gf_apps" {% if visible.gf_appearances %}checked{% endif %}> GF Apps</label>
<label><input type="checkbox" name="show_gf_wins" {% if visible.gf_wins %}checked{% endif %}> GF Wins</label>
<label><input type="checkbox" name="show_height" {% if visible.height %}checked{% endif %}> Height</label>
<label><input type="checkbox" name="show_years" {% if visible.years %}checked{% endif %}> Years Played</label>
<label><input type="checkbox" name="show_club_stats" {% if visible.club_stats %}checked{% endif %}> Club Breakdown</label>

<br><br>

<button type="submit">Search</button>

</form>
</div>

<table>
<tr>
    <th>Name</th>
    <th>Teams</th>

    {% if visible.career_games %}<th>Games</th>{% endif %}
    {% if visible.career_goals %}<th>Goals</th>{% endif %}
    {% if visible.max_goals_game %}<th>Max G (Game)</th>{% endif %}
    {% if visible.max_goals_season %}<th>Max G (Season)</th>{% endif %}
    {% if visible.max_goals_season_year %}<th>Season</th>{% endif %}
    {% if visible.max_disposals_game %}<th>Max D</th>{% endif %}
    {% if visible.max_kicks_game %}<th>Max K</th>{% endif %}
    {% if visible.all_aus %}<th>AA</th>{% endif %}
    {% if visible.all_aus_years %}<th>AA Years</th>{% endif %}
    {% if visible.aa_draft_pick %}<th>AA Draft Pick</th>{% endif %}
    {% if visible.brownlow_wins %}<th>BL Wins</th>{% endif %}
    {% if visible.brownlow_votes %}<th>BL Votes</th>{% endif %}
    {% if visible.gf_appearances %}<th>GF Apps</th>{% endif %}
    {% if visible.gf_wins %}<th>GF Wins</th>{% endif %}
    {% if visible.height %}<th>Height</th>{% endif %}
    {% if visible.years %}<th>Years</th>{% endif %}
    {% if visible.club_stats %}<th>Club Stats</th>{% endif %}
</tr>

{% for p in players %}
<tr>
    <td><a href="{{ p['player_id'] }}" target="_blank">{{ p['name'] }}</a></td>
    <td>{{ p['teams'] }}</td>

    {% if visible.career_games %}<td>{{ p['career_games'] }}</td>{% endif %}
    {% if visible.career_goals %}<td>{{ p['career_goals'] }}</td>{% endif %}
    {% if visible.max_goals_game %}<td>{{ p['max_goals_game'] }}</td>{% endif %}
    {% if visible.max_goals_season %}<td>{{ p['max_goals_season'] }}</td>{% endif %}
    {% if visible.max_goals_season_year %}<td>{{ p['max_goals_season_year'] }}</td>{% endif %}
    {% if visible.max_disposals_game %}<td>{{ p['max_disposals_game'] }}</td>{% endif %}
    {% if visible.max_kicks_game %}<td>{{ p['max_kicks_game'] }}</td>{% endif %}
    {% if visible.all_aus %}<td>{{ p['all_aus_count'] or 0 }}</td>{% endif %}
    {% if visible.all_aus_years %}
        <td class="aa-years">
            {% for y in aa_years.get(p['player_id'], []) %}
                {{ y }}{% if not loop.last %}, {% endif %}
            {% endfor %}
        </td>
    {% endif %}
    {% if visible.aa_draft_pick %}
        <td class="draft-pick">
            {% set dp = best_aa_draft.get(p['player_id']) %}
            {% if dp %}{{ dp.display }}{% else %}‚Äî{% endif %}
        </td>
    {% endif %}
    {% if visible.brownlow_wins %}<td>{{ p['brownlow_wins'] }}</td>{% endif %}
    {% if visible.brownlow_votes %}<td>{{ p['brownlow_votes'] }}</td>{% endif %}
    {% if visible.gf_appearances %}<td>{{ p['gf_appearances'] or 0 }}</td>{% endif %}
    {% if visible.gf_wins %}<td>{{ p['gf_wins'] or 0 }}</td>{% endif %}
    {% if visible.height %}<td>{{ p['height'] or '' }}</td>{% endif %}
    {% if visible.years %}<td>{{ p['first_year'] }} - {{ p['last_year'] }}</td>{% endif %}

    {% if visible.club_stats %}
    <td class="club-stats">
        {% for row in get_player_club_stats(p['player_id']) %}
            <div>{{ row.team }}: {{ row.games }}g / {{ row.goals }}gl</div>
        {% endfor %}
    </td>
    {% endif %}
</tr>
{% endfor %}
</table>

</body>
</html>